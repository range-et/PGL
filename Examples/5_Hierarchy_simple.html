<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="MasterStyle.css">
  <title>Hierarchy - Clustered graph (KD-tree distance)</title>
</head>

<body>
  <h4>Hierarchy: KD-tree clustering â€” simplified graph (super-nodes at centroids, thick edges)</h4>
  <p>Expected: fewer nodes and edges than the original; each node is a cluster centroid. No heavy bundling (keeps load fast).</p>
  <canvas id="displayCanvas" class="displayCanvas"></canvas>
  <script type="module">
    import * as PGL from "../Build/pgl_module.js";

    const original = await PGL.SampleData.LoadZKCSimulated();
    original.printData();

    const simplified = await PGL.Hierarchy.clusterByDistance(original, { distanceThreshold: 25 });
    simplified.printData();

    const lmap = PGL.Drawing.DrawEdgeLinesDivisions(simplified, 1);
    simplified.apply_edge_pos_maps(lmap);

    const width = 800;
    const height = 700;
    const canvas = document.getElementById("displayCanvas");
    const graph3d = new PGL.GraphDrawer.GraphDrawer3d({ graph: simplified, width, height, canvas });
    await graph3d.init();

    const bounds = 1;
    const nodeVisualElements = PGL.ThreeWrapper.DrawTHREEBoxBasedVertices(simplified, bounds, 0xffffff, 8);
    graph3d.addVisElement(nodeVisualElements);
    const edgeVisualElements = PGL.ThreeWrapper.DrawTHREEGraphEdgesThick(simplified, bounds, 0xffafcc, 1);
    graph3d.addVisElement(edgeVisualElements);

    function animate() {
      requestAnimationFrame(animate);
      graph3d.rendercall();
    }
    animate();
  </script>
</body>

</html>
